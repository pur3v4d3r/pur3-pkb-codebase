/*
═══════════════════════════════════════════════════════════
 SNIPPET: Spacing Foundation System
 Category: Core/Foundation
 Purpose: Unified spacing system to prevent conflicts
 Author: Pur3v4d3r
 Created: 2025-12-14
 Version: 1.0.0

 Description:
 Establishes consistent spacing values across all elements
 to eliminate the glitchy, inconsistent spacing caused by
 conflicting rules in multiple snippets.

 Dependencies: None (Load this FIRST)
 Priority: Load Order = 00 (loads before other snippets)

 Features:
 - CSS Custom Properties for consistent spacing
 - Unified line-height system
 - Proper paragraph spacing (NOT applied to every line)
 - Standardized heading margins
 - No conflicts with other snippets

 IMPORTANT: This file should be enabled FIRST and other
 spacing rules should be reviewed for conflicts.

 Compatibility: Obsidian 1.5+
═══════════════════════════════════════════════════════════
*/

/* ══════════════════════════════════════════════════════════
   SECTION 1: SPACING VARIABLES
   Central source of truth for all spacing values
   ══════════════════════════════════════════════════════════ */

:root {
  /* Line Heights - Consistent across all content */
  --line-height-tight: 1.4 ;        /* Headings, compact content */
  --line-height-normal: 1.5;       /* Body text, reading comfort */
  --line-height-relaxed: 1.7;      /* Callouts, detailed content */

  /* Vertical Spacing - Margins between elements */
  --spacing-xs: 0.25em;            /* Minimal spacing */
  --spacing-sm: 0.5em;             /* Small spacing */
  --spacing-md: 1em;               /* Medium spacing (default) */
  --spacing-lg: 1.5em;             /* Large spacing */
  --spacing-xl: 2em;               /* Extra large spacing */

  /* Paragraph Spacing */
  --paragraph-spacing: 1em;        /* Space between paragraphs */

  /* Heading Margins - Consistent hierarchy */
  --heading-margin-top: 1.5em;     /* Space before headings */
  --heading-margin-bottom: 0.5em;  /* Space after headings */
}

/* ══════════════════════════════════════════════════════════
   SECTION 2: PARAGRAPH SPACING
   FIXED: Only applies to actual paragraphs, NOT every line
   ══════════════════════════════════════════════════════════ */

/* Preview Mode Paragraphs */
.markdown-preview-view p {
  line-height: var(--line-height-normal) !important;
  margin-bottom: var(--paragraph-spacing) !important;
  margin-top: 0 !important;
}

/* Editor Mode - Base line height for ALL content */
.markdown-source-view.mod-cm6 .cm-content {
  line-height: var(--line-height-relaxed) !important;
}

/* DO NOT apply margin-bottom to .cm-line - it affects EVERY line! */
/* Instead, use proper selectors for specific elements */

/* ══════════════════════════════════════════════════════════
   SECTION 3: HEADING SPACING
   Unified margins for consistent visual hierarchy
   ══════════════════════════════════════════════════════════ */

/* H1 - Top Level */
.markdown-preview-view h1,
.markdown-source-view.mod-cm6 .HyperMD-header-1,
.cm-header-1,
h1 {
  line-height: var(--line-height-tight) !important;
  margin-top: var(--heading-margin-top) !important;
  margin-bottom: var(--heading-margin-bottom) !important;
}

/* H2 - Major Sections */
.markdown-preview-view h2,
.markdown-source-view.mod-cm6 .HyperMD-header-2,
.cm-header-2,
h2 {
  line-height: var(--line-height-tight) !important;
  margin-top: calc(var(--heading-margin-top) * 0.9) !important;  /* Slightly less than H1 */
  margin-bottom: var(--heading-margin-bottom) !important;
}

/* H3 - Subsections */
.markdown-preview-view h3,
.markdown-source-view.mod-cm6 .HyperMD-header-3,
.cm-header-3,
h3 {
  line-height: var(--line-height-tight) !important;
  margin-top: calc(var(--heading-margin-top) * 0.8) !important;
  margin-bottom: var(--heading-margin-bottom) !important;
}

/* H4-H6 - Minor Sections */
.markdown-preview-view h4,
.markdown-preview-view h5,
.markdown-preview-view h6,
.markdown-source-view.mod-cm6 .HyperMD-header-4,
.markdown-source-view.mod-cm6 .HyperMD-header-5,
.markdown-source-view.mod-cm6 .HyperMD-header-6,
.cm-header-4,
.cm-header-5,
.cm-header-6,
h4, h5, h6 {
  line-height: var(--line-height-tight) !important;
  margin-top: var(--spacing-md) !important;
  margin-bottom: var(--spacing-sm) !important;
}

/* ══════════════════════════════════════════════════════════
   SECTION 4: LIST SPACING
   Proper spacing for lists without extra gaps
   ══════════════════════════════════════════════════════════ */

/* Ordered and Unordered Lists */
.markdown-preview-view ul,
.markdown-preview-view ol {
  margin-top: var(--spacing-sm) !important;
  margin-bottom: var(--spacing-md) !important;
  padding-left: 2em !important;
}

/* List Items - Comfortable reading spacing */
.markdown-preview-view li {
  margin-bottom: var(--spacing-xs) !important;
  line-height: var(--line-height-normal) !important;
}

/* Nested Lists - Tighter spacing */
.markdown-preview-view li li {
  margin-bottom: 0 !important;
}

/* ══════════════════════════════════════════════════════════
   SECTION 5: INLINE ELEMENTS
   No vertical spacing, only horizontal
   ══════════════════════════════════════════════════════════ */

/* Inline Code */
.markdown-preview-view code:not(pre code),
.cm-inline-code {
  margin: 0 !important;          /* No vertical margin */
  padding: 0.1em 0.3em !important;
  line-height: inherit !important;
}

/* Bold and Italic - Inherit spacing */
.markdown-preview-view strong,
.markdown-preview-view em,
.cm-strong,
.cm-em {
  margin: 0 !important;
  padding: 0 !important;
  line-height: inherit !important;
}

/* ══════════════════════════════════════════════════════════
   SECTION 6: BLOCK ELEMENTS
   Consistent spacing for code blocks, quotes, etc.
   ══════════════════════════════════════════════════════════ */

/* Code Blocks */
.markdown-preview-view pre,
.markdown-preview-view pre code {
  margin-top: var(--spacing-md) !important;
  margin-bottom: var(--spacing-md) !important;
  line-height: var(--line-height-normal) !important;
}

/* Blockquotes */
.markdown-preview-view blockquote {
  margin-top: var(--spacing-md) !important;
  margin-bottom: var(--spacing-md) !important;
  padding: var(--spacing-sm) var(--spacing-md) !important;
  line-height: var(--line-height-normal) !important;
}

/* Horizontal Rules */
.markdown-preview-view hr {
  margin-top: var(--spacing-xl) !important;
  margin-bottom: var(--spacing-xl) !important;
}

/* ══════════════════════════════════════════════════════════
   SECTION 7: TABLES
   Consistent spacing within and around tables
   ══════════════════════════════════════════════════════════ */

.markdown-preview-view table {
  margin-top: var(--spacing-lg) !important;
  margin-bottom: var(--spacing-lg) !important;
  line-height: var(--line-height-tight) !important;
}

.markdown-preview-view th,
.markdown-preview-view td {
  padding: 0.5em 0.75em !important;
  line-height: var(--line-height-tight) !important;
}

/* ══════════════════════════════════════════════════════════
   SECTION 8: CALLOUTS
   Base spacing for callouts (specific styles in other files)
   ══════════════════════════════════════════════════════════ */

.callout {
  margin-top: var(--spacing-md) !important;
  margin-bottom: var(--spacing-md) !important;
}

.callout-content {
  line-height: var(--line-height-relaxed) !important;
}

.callout-content p {
  margin-bottom: var(--spacing-sm) !important;
}

.callout-content p:last-child {
  margin-bottom: 0 !important;
}

/* ══════════════════════════════════════════════════════════
   SECTION 9: SPECIAL CASES
   Edge cases and overrides
   ══════════════════════════════════════════════════════════ */

/* First paragraph after heading - reduce space */
.markdown-preview-view h1 + p,
.markdown-preview-view h2 + p,
.markdown-preview-view h3 + p,
.markdown-preview-view h4 + p,
.markdown-preview-view h5 + p,
.markdown-preview-view h6 + p {
  margin-top: 0 !important;
}

/* Last paragraph before heading - normal space */
.markdown-preview-view p:has(+ h1),
.markdown-preview-view p:has(+ h2),
.markdown-preview-view p:has(+ h3) {
  margin-bottom: var(--spacing-md) !important;
}

/* Inline Title (Note Title at Top) */
.inline-title {
  margin-bottom: var(--spacing-md) !important;  /* FIXED: Added unit */
  line-height: var(--line-height-tight) !important;
}

/* ══════════════════════════════════════════════════════════
   SECTION 10: OVERRIDE PROTECTION
   Prevent other snippets from breaking spacing
   ══════════════════════════════════════════════════════════ */

/* Ensure .cm-line does NOT get paragraph spacing */
.markdown-source-view.mod-cm6 .cm-line {
  margin-bottom: 0 !important;    /* CRITICAL: Prevents spacing on every line */
  margin-top: 0 !important;
}

/* ══════════════════════════════════════════════════════════
   END OF SPACING FOUNDATION
   ══════════════════════════════════════════════════════════ */
